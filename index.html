
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MannKoboli - Mental Health AI Counselor</title>
    <style>
        * {
            addFallbackResponse(userMessage) {
                const keywords = userMessage.toLowerCase();
                let response = '';
                
                // Analyze user input for emotional content and respond appropriately
                if (keywords.includes('anxious') || keywords.includes('anxiety') || keywords.includes('worried') || keywords.includes('panic')) {
                    response = `I can sense you're dealing with anxiety right now. Let's work through this together with some proven techniques:

🌬️ **Immediate Relief - Box Breathing:**
• Breathe in for 4 counts
• Hold for 4 counts  
• Exhale for 4 counts
• Hold empty for 4 counts
• Repeat 4-6 times

🧘 **5-4-3-2-1 Grounding:**
• 5 things you can see
• 4 things you can touch
• 3 things you can hear
• 2 things you can smell
• 1 thing you can taste

💭 **Anxiety Thoughts:** Remember, anxiety often makes threats seem bigger than they are. Ask yourself: "Is this thought helpful right now?" and "What would I tell a friend in this situation?"

Would you like to tell me more about what's making you feel anxious today?`;

                } else if (keywords.includes('sad') || keywords.includes('depressed') || keywords.includes('down') || keywords.includes('hopeless')) {
                    response = `I hear that you're going through a really tough time right now. Your feelings are completely valid, and reaching out shows incredible strength.

🌱 **Gentle Self-Care:**
• Try to do one small thing that usually brings comfort
• Even 5 minutes outside can help shift your mood
• Consider calling someone who cares about you

💪 **When Everything Feels Hard:**
• Break tasks into tiny steps (even "get out of bed" counts)
• Celebrate small wins - they matter more than you think
• Remember: feelings are temporary, even when they feel permanent

🤝 **You're Not Alone:** Depression lies and tells us we're isolated, but you're not. Many people care about you, even when it doesn't feel that way.

What's been the hardest part of your day today? Sometimes talking about it helps.`;

                } else if (keywords.includes('stress') || keywords.includes('overwhelmed') || keywords.includes('pressure')) {
                    response = `Feeling overwhelmed is your mind's way of saying "this is a lot to handle." Let's break it down together:

📝 **Brain Dump Exercise:**
• Write everything that's stressing you (don't organize yet)
• Circle what you can control vs. what you can't
• Pick just ONE thing to focus on today

⏰ **The 2-Minute Rule:**
• If something takes less than 2 minutes, do it now
• For bigger tasks, just commit to 2 minutes of work
• Often starting is the hardest part

🛑 **Permission to Say No:**
• Your plate is full - it's okay to decline new commitments
• "I can't take that on right now" is a complete sentence

What's the biggest thing on your mind right now? Let's tackle it step by step.`;

                } else if (keywords.includes('sleep') || keywords.includes('insomnia') || keywords.includes('tired') || keywords.includes('exhausted')) {
                    response = `Sleep troubles can make everything feel harder. Let's work on getting you better rest:

🌙 **Tonight's Sleep Plan:**
• Set a "wind-down" alarm 1 hour before bed
• No screens after that alarm (or use blue light filters)
• Try progressive muscle relaxation: tense and release each muscle group

🛏️ **Sleep Environment:**
• Cool, dark, and quiet room
• Consider white noise or earplugs
• Your bed should be for sleep only (no work, no phone scrolling)

☕ **Daytime Habits That Help:**
• Get sunlight in the morning (even 10 minutes)
• Avoid caffeine after 2 PM
• Light exercise earlier in the day

How many hours of sleep have you been getting lately? And what's your current bedtime routine like?`;

                } else if (keywords.includes('lonely') || keywords.includes('alone') || keywords.includes('isolated')) {
                    response = `Loneliness is one of the most painful feelings, but reaching out here shows you're fighting it. That takes courage.

🤝 **Connection Ideas:**
• Text someone you haven't talked to in a while - just "thinking of you"
• Join online communities related to your interests
• Volunteer opportunities often provide meaningful connection

💭 **Reframing Loneliness:**
• Being alone doesn't always mean being lonely
• Sometimes loneliness is about not feeling understood, not just being alone
• Quality of connection matters more than quantity

🌟 **Small Steps:**
• Smile at a cashier or neighbor
• Comment thoughtfully on social media posts
• Join a class or group (online or in-person)

What kind of connection are you missing most right now? Talking with friends, family, or meeting new people?`;

                } else if (keywords.includes('angry') || keywords.includes('frustrated') || keywords.includes('mad')) {
                    response = `Anger often masks other feelings like hurt, fear, or feeling powerless. Let's work with this energy constructively:

🔥 **Immediate Anger Management:**
• Count to 10 (or 100) before responding
• Take 5 deep breaths, focusing on making the exhale longer
• Physical release: punch a pillow, go for a walk, do jumping jacks

💭 **Understanding Your Anger:**
• What triggered this feeling?
• What need of yours isn't being met?
• Is the anger proportional to the situation?

⚡ **Channel the Energy:**
• Anger gives us energy - use it for positive change
• Write about what made you angry (then decide if you want to send/say it)
• Physical exercise can transform anger into strength

What's driving your anger right now? Sometimes naming it specifically helps reduce its power.`;

                } else {
                    response = `Thank you for sharing with me. I can hear that you're going through something important, and I want you to know that your feelings matter.

💚 **Universal Mental Health Reminders:**
• Your feelings are valid, even if others don't understand them
• It's okay to not be okay sometimes
• Taking care of your mental health isn't selfish - it's necessary
• Small steps count just as much as big ones

🌱 **Today's Gentle Goals:**
• One thing for your body (water, food, movement, rest)
• One thing for your mind (meditation, reading, music, art)  
• One thing for connection (text a friend, hug a pet, call family)

🆘 **If You're in Crisis:**
• National Suicide Prevention Lifeline: 988
• Crisis Text Line: Text HOME to 741741
• Emergency Services: 911

I'm here to listen. What's been on your mind lately? You don't have to go through this alone.`;
                }
                
                this.addMessage(response, 'ai');
                
                // Add a follow-up question after a brief pause
                setTimeout(() => {
                    const followUp = "How are you feeling after trying any of these suggestions? I'm here to continue our conversation and support you through this. 💙";
                    this.addMessage(followUp, 'ai');
                }, 3000);
            }
            
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }
        
        .logo {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .tagline {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 30px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .info-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }
        
        .chat-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            height: 600px;
        }
        
        .panel-title {
            font-size: 1.8em;
            color: #4a5568;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .chat-container {
            flex: 1;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            overflow-y: auto;
            padding: 20px;
            margin-bottom: 20px;
            background: #f8fafc;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 80%;
            word-wrap: break-word;
        }
        
        .user-message {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            margin-left: auto;
        }
        
        .ai-message {
            background: #e2e8f0;
            color: #2d3748;
            margin-right: auto;
        }
        
        .input-container {
            display: flex;
            gap: 10px;
        }
        
        .message-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .message-input:focus {
            border-color: #667eea;
        }
        
        .send-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s;
        }
        
        .send-btn:hover {
            transform: translateY(-2px);
        }
        
        .send-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        

        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        .feature-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .loading {
            display: none;
            text-align: center;
            color: #667eea;
            font-style: italic;
        }
        
        .mental-health-tips {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .tip-item {
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .tip-item:last-child {
            border-bottom: none;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .chat-panel {
                height: 500px;
            }
            
            .logo {
                font-size: 2em;
            }
        }
        
        .warning {
            background: #fed7d7;
            border: 1px solid #feb2b2;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: #c53030;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">🧠 MannKoboli</div>
            <div class="tagline">Your AI Mental Health Companion - Powered by DeepSeek R1</div>
        </header>
        

        
        <div class="warning">
            <strong>Important:</strong> This AI counselor is for support and information only. In case of emergency or severe mental health crisis, please contact emergency services or a licensed mental health professional immediately.
        </div>
        
        <div class="main-content">
            <div class="info-panel">
                <h2 class="panel-title">Mental Health Awareness</h2>
                <p style="margin-bottom: 20px;">
                    Mental health is just as important as physical health. Our AI counselor is here to provide support, 
                    guidance, and resources to help you navigate life's challenges.
                </p>
                
                <div class="mental-health-tips">
                    <h3 style="margin-bottom: 15px;">💡 Daily Wellness Tips</h3>
                    <div class="tip-item">
                        <strong>🌅 Morning Routine:</strong> Start your day with 5 minutes of deep breathing or meditation
                    </div>
                    <div class="tip-item">
                        <strong>🚶 Physical Activity:</strong> Take a 10-minute walk outdoors to boost mood and energy
                    </div>
                    <div class="tip-item">
                        <strong>📱 Digital Detox:</strong> Set boundaries with social media and screen time
                    </div>
                    <div class="tip-item">
                        <strong>💤 Sleep Hygiene:</strong> Maintain consistent sleep schedule for better mental health
                    </div>
                    <div class="tip-item">
                        <strong>🤝 Social Connection:</strong> Reach out to friends or family regularly
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #e6fffa; border-radius: 10px;">
                    <h4>🆘 Crisis Resources</h4>
                    <p><strong>National Suicide Prevention Lifeline:</strong> 988</p>
                    <p><strong>Crisis Text Line:</strong> Text HOME to 741741</p>
                    <p><strong>International Association for Suicide Prevention:</strong> <a href="https://www.iasp.info/resources/Crisis_Centres/">Crisis Centers</a></p>
                </div>
            </div>
            
            <div class="chat-panel">
                <h2 class="panel-title">💬 AI Counselor Chat</h2>
                <div id="chatContainer" class="chat-container">
                    <div class="message ai-message">
                        Hello! I'm your AI mental health companion powered by DeepSeek R1. I'm here to listen, support, and provide guidance. 
                        How are you feeling today? Remember, this is a safe space where you can share your thoughts and concerns.
                    </div>
                </div>
                <div class="loading" id="loading">AI is thinking...</div>
                <div class="input-container">
                    <input type="text" id="messageInput" class="message-input" placeholder="Share your thoughts or ask for support..." maxlength="500">
                    <button id="sendBtn" class="send-btn">Send</button>
                </div>
            </div>
        </div>
        
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">🤖</div>
                <h3>AI-Powered Support</h3>
                <p>Advanced DeepSeek R1 model provides empathetic and intelligent responses to your mental health concerns.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">🔒</div>
                <h3>Private & Secure</h3>
                <p>Your conversations are private and secure. We prioritize your confidentiality and data protection.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">🌟</div>
                <h3>24/7 Availability</h3>
                <p>Get support whenever you need it. Our AI counselor is available around the clock for your mental wellness.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">🎯</div>
                <h3>Personalized Guidance</h3>
                <p>Receive tailored advice and coping strategies based on your unique situation and needs.</p>
            </div>
        </div>
    </div>
    
    <script>
        class MannKoboli {
            constructor() {
                this.apiKey = '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';
                this.chatContainer = document.getElementById('chatContainer');
                this.messageInput = document.getElementById('messageInput');
                this.sendBtn = document.getElementById('sendBtn');
                this.loading = document.getElementById('loading');
                
                this.init();
            }
            
            init() {
                this.sendBtn.addEventListener('click', () => this.sendMessage());
                this.messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendMessage();
                });
            }
            
            async sendMessage() {
                const message = this.messageInput.value.trim();
                if (!message) return;
                
                // Add user message
                this.addMessage(message, 'user');
                this.messageInput.value = '';
                
                // Show loading
                this.showLoading(true);
                this.sendBtn.disabled = true;
                
                try {
                    const response = await this.callDeepSeekAPI(message);
                    this.addMessage(response, 'ai');
                } catch (error) {
                    console.error('Error:', error);
                    if (error.message === 'CORS_ERROR') {
                        this.addMessage('I\'m currently running in offline mode due to browser security restrictions. Let me provide you with personalized mental health support based on what you\'ve shared.', 'ai');
                        setTimeout(() => this.addFallbackResponse(message), 500);
                    } else {
                        this.addMessage('I\'m having connection difficulties right now, but I\'m here to help with local mental health resources and support.', 'ai');
                        setTimeout(() => this.addFallbackResponse(message), 500);
                    }
                }
                
                this.showLoading(false);
                this.sendBtn.disabled = false;
            }
            
            async callDeepSeekAPI(userMessage) {
                const systemPrompt = `You are a compassionate AI mental health counselor. Your role is to:
                
                1. Provide empathetic, supportive responses
                2. Listen actively and validate emotions
                3. Offer practical coping strategies and techniques
                4. Encourage professional help when appropriate
                5. Maintain appropriate boundaries - you are not a replacement for professional therapy
                6. Be culturally sensitive and non-judgmental
                7. Recognize signs of crisis and provide appropriate resources
                
                Guidelines:
                - Always prioritize safety and well-being
                - Provide evidence-based mental health information
                - Use warm, understanding language
                - Ask follow-up questions to better understand concerns
                - Suggest breathing exercises, mindfulness, or other immediate coping strategies when helpful
                - If someone mentions self-harm or suicide, provide crisis resources and encourage immediate professional help
                
                Remember: You are a supportive companion, not a licensed therapist. Encourage professional help for serious mental health concerns.`;
                
                // Try multiple approaches to handle CORS
                const endpoints = [
                    'https://openrouter.ai/api/v1/chat/completions',
                    'https://api.openrouter.ai/api/v1/chat/completions'
                ];
                
                const requestBody = {
                    model: 'deepseek/deepseek-r1',
                    messages: [
                        { role: 'system', content: systemPrompt },
                        { role: 'user', content: userMessage }
                    ],
                    max_tokens: 800,
                    temperature: 0.7,
                    top_p: 0.9,
                    stream: false
                };
                
                for (let endpoint of endpoints) {
                    try {
                        const response = await fetch(endpoint, {
                            method: 'POST',
                            mode: 'cors',
                            credentials: 'omit',
                            headers: {
                                'Authorization': `Bearer ${this.apiKey}`,
                                'Content-Type': 'application/json',
                                'HTTP-Referer': window.location.origin || 'https://mannkoboli.local',
                                'X-Title': 'MannKoboli Mental Health AI'
                            },
                            body: JSON.stringify(requestBody)
                        });
                        
                        if (response.ok) {
                            const data = await response.json();
                            if (data.choices && data.choices[0] && data.choices[0].message) {
                                return data.choices[0].message.content;
                            }
                        }
                        
                    } catch (error) {
                        console.warn(`Failed to connect to ${endpoint}:`, error);
                        continue;
                    }
                }
                
                // If all endpoints fail, throw CORS error
                throw new Error('CORS_ERROR');
            }
            
            addMessage(content, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}-message`;
                messageDiv.textContent = content;
                
                this.chatContainer.appendChild(messageDiv);
                this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
            }
            
            showLoading(show) {
                this.loading.style.display = show ? 'block' : 'none';
            }
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new MannKoboli();
        });
        
        // Add some interactive elements
        document.addEventListener('DOMContentLoaded', () => {
            // Animate feature cards on scroll
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);
            
            document.querySelectorAll('.feature-card').forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'opacity 0.6s, transform 0.6s';
                observer.observe(card);
            });
        });
    </script>
</body>
</html>
